{
  "metadata": {
    "name": "ThreatSpec",
    "version": "0.1",
    "created": 1448303725,
    "updated": 1448303725
  },
  "boundaries": {
    "@webapp": {
      "name": "WebApp"
    }
  },
  "components": {
    "@app": {
      "name": "App"
    },
    "@filesystem": {
      "name": "FileSystem"
    },
    "@user": {
      "name": "User"
    },
    "@web": {
      "name": "Web"
    }
  },
  "threats": {
    "@arbitrary_file_reads": {
      "name": "arbitrary file reads",
      "reference": ""
    },
    "@arbitrary_file_writes": {
      "name": "arbitrary file writes",
      "reference": ""
    },
    "@cats_like_milk": {
      "name": "true story",
      "reference": ""
    },
    "@content_injection": {
      "name": "content injection",
      "reference": ""
    },
    "@cwe_319_cleartext_transmission": {
      "name": "The software transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors",
      "reference": ""
    },
    "@privilege_escalation": {
      "name": "privilege escalation",
      "reference": ""
    },
    "@resource_access_abuse": {
      "name": "resource access abuse",
      "reference": ""
    },
    "@unauthorised_access": {
      "name": "unauthorised access",
      "reference": ""
    },
    "@xss_injection": {
      "name": "XSS injection",
      "reference": ""
    }
  },
  "projects": {
    "Simple": {
      "mitigations": {
        "@basic_input_validation": [
          {
            "mitigation": "basic input validation",
            "boundary": "@webapp",
            "component": "@web",
            "threat": "@resource_access_abuse",
            "reference": "",
            "source": {
              "function": "main.makeHandler",
              "file": "simple.go",
              "line": 86
            }
          }
        ],
        "@nonprivileged_port": [
          {
            "mitigation": "non-privileged port",
            "boundary": "@webapp",
            "component": "@web",
            "threat": "@privilege_escalation",
            "reference": "",
            "source": {
              "function": "main.main",
              "file": "simple.go",
              "line": 99
            }
          }
        ],
        "@strict_file_permissions": [
          {
            "mitigation": "strict file permissions",
            "boundary": "@webapp",
            "component": "@filesystem",
            "threat": "@unauthorised_access",
            "reference": "",
            "source": {
              "function": "main.(*Page).save",
              "file": "simple.go",
              "line": 29
            }
          }
        ]
      },
      "exposures": {
        "@insufficient_input_validation": [
          {
            "exposure": "insufficient input validation",
            "boundary": "@webapp",
            "component": "@app",
            "threat": "@xss_injection",
            "reference": "",
            "source": {
              "function": "main.editHandler",
              "file": "simple.go",
              "line": 54
            }
          },
          {
            "exposure": "insufficient input validation",
            "boundary": "@webapp",
            "component": "@app",
            "threat": "@content_injection",
            "reference": "",
            "source": {
              "function": "main.saveHandler",
              "file": "simple.go",
              "line": 63
            }
          }
        ]
      },
      "transfers": {
        "@nonsensitive_information": [
          {
            "transfer": "non-sensitive information",
            "boundary": "",
            "component": "@user",
            "threat": "@cwe_319_cleartext_transmission",
            "reference": "",
            "source": {
              "function": "main.main",
              "file": "simple.go",
              "line": 99
            }
          }
        ]
      },
      "acceptances": {
        "@filename_restrictions": [
          {
            "acceptance": "filename restrictions",
            "boundary": "@webapp",
            "component": "@filesystem",
            "threat": "@arbitrary_file_writes",
            "reference": "",
            "source": {
              "function": "main.(*Page).save",
              "file": "simple.go",
              "line": 29
            }
          },
          {
            "acceptance": "filename restrictions",
            "boundary": "@webapp",
            "component": "@filesystem",
            "threat": "@arbitrary_file_reads",
            "reference": "",
            "source": {
              "function": "main.loadPage",
              "file": "simple.go",
              "line": 35
            }
          }
        ]
      }
    }
  }
}